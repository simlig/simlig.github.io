<!doctype html>

<title>Final Project</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<link rel="stylesheet" media="screen" href="ProfessionalWebsite.css">

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<body>
    <div id="center" style="font: 60px Calibri;">
    
        <div class="container">
            <div id="pages" class="carousel slide" data-interval="false" data-ride="carousel">

                <!-- Indicators -->
                <!-- <ol class="carousel-indicators" >
                    <li data-target="#pages" data-slide-to="0" class="active"></li>
                    <li data-target="#pages" data-slide-to="1"></li>
                    <li data-target="#pages" data-slide-to="2"></li>
                    <li data-target="#pages" data-slide-to="3"></li>
                    <li data-target="#pages" data-slide-to="4"></li>
                    <li data-target="#pages" data-slide-to="5"></li>
                </ol> -->

                <!-- Wrapper for slides -->
                <div class="carousel-inner">

                    <div class="item active"> 
                        <p>My name is Sam</p>
                    </div>

                    <div class="item">
                        <p>This is my website</p>
                    </div>

                    <div class="item">
                        <p style="font-size: 90%">
                            Let me expand your classical mind
                        </p>
                    </div>

                    <div class="item">
                        <p>
                            Consider this quote:
                        </p>
                    </div>

                    <div class="item">
                        <p id="quote">

                        </p>
                        <p id="author">

                        </p>
                    </div>

                    <div class="item">
                        <p>
                            What do you think?
                        </p>
                    </div>

                    <div class="item">
                        <p>
                            Has it inspired you?
                        </p>
                    </div>

                    <div class="item">
                        <p>
                            Made you feel something?
                        </p>
                    </div>

                    <div class="item">
                        <p style="font-size: 80%">
                            If not, perhaps you need something more technological
                        </p>
                    </div>

                    <div class="item">
                        <svg class='img-responsive' id='target_intro' viewBox="0 0 1500 700"></svg>
                        <p>
                            Examine this target
                        </p>
                    </div>

                    <div class="item">
                        <p>
                            Let's practice your aim
                        </p>
                    </div>

                    <div class="item">
                        <svg class='img-responsive' id='moving_target' viewBox="0 0 1500 700"></svg>
                        <p id="moving_target_text">

                        </p>
                    </div>



                    <div class="item">
                        <p>
                            Let's pickup the pace
                        </p>
                    </div>

                    <div class="item">
                        <p style="font-size: 90%">
                            This next one is gonna take some skill
                        </p>
                    </div>

                    <div class="item">
                        <svg class='img-responsive' id='target' viewBox="0 0 1500 700"></svg>
                    </div>

                    <div class="item">
                        <p>
                            <button class="btn btn-primary btn-lg" id="resultbutton" onclick="displayResults()">Display Results</button>
                            <p id="results">

                                <!--<table style="width:50%">
                                    <tr>
                                        <th id="th1"><strong></strong></th>
                                        <th id="th2"><strong></strong></th>
                                        <th id="th3"><strong></strong></th>
                                        <th id="th4"><strong></strong></th>
                                        <th id="th5"><strong></strong></th>
                                    </tr>
                                    <tr>
                                        <td id="td1"></td>
                                        <td id="td2"></td>
                                        <td id="td3"></td>
                                        <td id="td4"></td>
                                        <td id="td5"></td>
                                    </tr>
                                </table>--->
                            </p>
                        </p>
                        
                            
                    </div>
                   

                </div>

                <!-- Left and right controls -->
                <a class="left carousel-control" href="#pages" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left"></span>
                <span class="sr-only">Previous</span>
                </a>

                <a class="right carousel-control" href="#pages" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right"></span>
                <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
    </div>

    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>

    <!-- This file is from the JavaScript Library Snap SVG. Its used to create SVG art.
        I've gone ahead and downloaded the src file for snap svg, as the only option
        was a download system. -->
    <script src="snap.svg-min.js"></script>

    <script>

        // Creates counters to track user accuracy
        var targetGreenCounter = 0;
        var targetRedCounter = 0;
        var targetWhiteCounter = 0;
        var targetBlueCounter = 0;

        function main()
        {
            fetchQuotes();
            targetIntro();
            targetShootingRange();
            slowMovingTarget();

            // Always keep refreshing results
            // Put it at 1.5 seconds and realistically, could be longer
            // to improve performance
            let timerId = setInterval(displayResults, 1500);
        }

        /**
         * The starting target
         */
        function targetIntro()
        {
            let snap = Snap("#target_intro")

            // Creates the four circles that make up the target
            let circle1 = snap.circle(600, 350, 190);
            let circle2 = snap.circle(600, 350, 140);
            let circle3 = snap.circle(600, 350, 80);
            let circle4 = snap.circle(600, 350, 20);

            // Sets the attribute for all circles required
            setCircles(circle1, circle2, circle3, circle4);

            // Creates the functionality for everything to change colors, based
            // on which sub circle was clicked. Helps the user see their accuracy
            circle1.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle1.attr("fill"), ""); });
            circle2.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle2.attr("fill"), ""); });
            circle3.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle3.attr("fill"), ""); });
            circle4.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle4.attr("fill"), ""); });

            // Groups all circles together, so that these functions can be
            // used on any part of the target
            let startingTargetGroup = snap.g(circle1, circle2, circle3, circle4)
            startingTargetGroup.drag(onDrag, onBegin);
            startingTargetGroup.hover(hoverOver, hoverOut);
            startingTargetGroup.mouseup(() => { mouseUp(circle1, circle2, circle3, circle4); });
            startingTargetGroup.touchstart(mobileTouch);
        }


        /**
         * The shooting range target
         */
        function targetShootingRange()
        {
            let targetSnap = Snap("#target");

            // Creates 4 circles in the svg segment with id target
            let circle1 = targetSnap.circle(600, 350, 150);
            let circle2 = targetSnap.circle(600, 350, 100);
            let circle3 = targetSnap.circle(600, 350, 50);
            let circle4 = targetSnap.circle(600, 350, 20);

            // Sets the attributes for all of the necessary circles
            setCircles(circle1, circle2, circle3, circle4);

            // Groups all circles together
            let shootingRangeGroup = targetSnap.g(circle1, circle2, circle3, circle4);


            // Changes the color of the target based on user accuracy
            circle1.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle1.attr("fill"), "blue"); });
            circle2.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle2.attr("fill"), "white"); });
            circle3.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle3.attr("fill"), "red"); });
            circle4.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle4.attr("fill"), "green"); });

            // Moves the target when its clicked to a random location
            shootingRangeGroup.mouseup(() => { shootingRange(shootingRangeGroup, circle1, circle2, circle3, circle4); });
            shootingRangeGroup.hover(hoverOver, hoverOut);
        }    

        /**
         * The slow moving target 
         */
        function slowMovingTarget()
        {
            let movingTargetSnap = Snap("#moving_target");

            // Creates 4 circles in the svg segment with id target
            let circle1 = movingTargetSnap.circle(600, 350, 150);
            let circle2 = movingTargetSnap.circle(600, 350, 100);
            let circle3 = movingTargetSnap.circle(600, 350, 50);
            let circle4 = movingTargetSnap.circle(600, 350, 20);

            // Sets the attributes for all of the necessary circles
            setCircles(circle1, circle2, circle3, circle4);

            // Changes the color of the target based on user accuracy
            circle1.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle1.attr("fill"), ""); });
            circle2.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle2.attr("fill"), ""); });
            circle3.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle3.attr("fill"), ""); });
            circle4.mousedown(() => { circleClicked(circle1, circle2, circle3, circle4, circle4.attr("fill"), ""); });

            // Groups all circles together
            let movingGroup = movingTargetSnap.g(circle1, circle2, circle3, circle4);

            movingGroup.mouseup(() => { mouseUp(circle1, circle2, circle3, circle4); });
            movingGroup.hover(hoverOver, hoverOut);

            let timerId = setInterval(() => { animateTarget(movingGroup); }, 20);

            movingGroup.mousedown(() => { clear(timerId); });
        }

        var value = 0;
        var boolean = true;

        /**
         * Creates an animation for the target 
         */
        function animateTarget(movingGroup)
        {
            if (value < 500 && boolean)
            {
                for (var i = value; i < value + 10; i++)
                {
                    movingGroup.transform('t' + i + ',' + (0));
                }
            }
            else
            {
                if (value > -400 && !boolean)
                {
                    for (var i = value; i > value - 10; i--)
                    {
                        movingGroup.transform('t' + i + ',' + (0));
                    }
                }

            }

            value = i;

            if (value == -400)
            {
                boolean = true;
            }
            else if (value == 500)
            {
                boolean = false;
            }
        }

        function resetResults()
        {
            targetGreenCounter = 0;
            targetRedCounter = 0;
            targetWhiteCounter = 0;
            targetBlueCounter = 0;

            document.getElementById("resultbutton").textContent = "Calculate score";
            
            document.getElementById("resultbutton").setAttribute('onclick','displayResults()')
        }

        function displayResults()
        {
            document.getElementById("results").innerHTML = "# of Hits: " +
                (targetRedCounter + targetWhiteCounter + targetGreenCounter + targetBlueCounter) + "<br>" + 
                "# of Green Hit: " + targetGreenCounter + "<br>" + "# of Red Hit: " +
                targetRedCounter + "<br>" + "# of Whites: " + targetWhiteCounter + "<br>" +
                "# of Blue Hit: " + targetBlueCounter;

            document.getElementById("resultbutton").textContent = "Reset score";
            document.getElementById("resultbutton").setAttribute('onclick','resetResults()')

            //document.getElementById("th1").innerHTML = "Total number of hits";
            //document.getElementById("th2").innerHTML = "Number of Perfects";
            //document.getElementById("th3").innerHTML = "Number of Greats";
            //document.getElementById("th4").innerHTML = "Number of Goods";
            //document.getElementById("th5").innerHTML = "Number of Near Misses";

        }

        function circleClicked(givenCircle1, givenCircle2, givenCircle3, givenCircle4, color, accuracy)
        {
            givenCircle1.attr({
                fill: color,
            });
            givenCircle2.attr({
                fill: color,
            });
            givenCircle3.attr({
                fill: color,
            });
            givenCircle4.attr({
                fill: color,
            })

            if (accuracy == "blue")
            {
                targetBlueCounter += 1;
            }

            else if (accuracy == "white")
            {
                targetWhiteCounter += 1;
            }

            else if (accuracy == "red")
            {
                targetRedCounter += 1;
            }

            else if (accuracy == "green")
            {
                targetGreenCounter += 1;
            }
        }


        /**
         * Stops the animation 
         */
        function clear(timerId)
        {
            clearInterval(timerId);
        }

        /**
         * Gets a random integer between the min and max
         */
        function getRandInteger(min, max)
        {
            return Math.floor(Math.random() * (max - min + 1) ) + min;
        }

        /**
         * Moves the target around 
         */
        function shootingRange(shootingRangeGroup, providedCircle1, providedCircle2, providedCircle3, providedCircle4)
        {
            mouseUp(providedCircle1, providedCircle2, providedCircle3, providedCircle4);
            shootingRangeGroup.transform('t' + (getRandInteger(-400, 600)) + ',' + (getRandInteger(-100, 250)));

            console.log(targetGreenCounter);
            console.log(targetRedCounter);
            console.log(targetWhiteCounter);
            console.log(targetBlueCounter);
        }

        /**
         * Creates the colors for the target on the outermost circle
         */
        function setCircle1(providedCircle)
        {
            // Each circle's basic attributes
            providedCircle.attr({
                fill: "blue",
                stroke: "black",
                strokeWidth: 10
            });
        }

        /**
         * Creates the colors for the target on the second-outermost circle 
         */
        function setCircle2(providedCircle)
        {
            providedCircle.attr({
                fill: "white",
                stroke: "black",
                strokeWidth: 20
            });
        }

        /**
         * Creates the colors for the target on the second to innermost circle
         */
        function setCircle3(providedCircle)
        {
            providedCircle.attr({
                fill: "red",
                stroke: "black",
                strokeWidth: 10
            });
        }

        /**
         * Creates the colors for the target on the innermost circle
         */
         function setCircle4(providedCircle)
        {
            providedCircle.attr({
                fill: "forestgreen",
                stroke: "black",
                strokeWidth: 10
            });
        }

        /**
         * Sets all circles
         */
        function setCircles(providedCircle1, providedCircle2, providedCircle3, providedCircle4)
        {
            setCircle1(providedCircle1);
            setCircle2(providedCircle2);
            setCircle3(providedCircle3);
            setCircle4(providedCircle4);
        }

        // Functions for SVG Manipulation
        /**
         * Touching for mobile devices
         */
        function mobileTouch()
        {
            circle1.attr({
                fill: "red",
                stroke: "red"
            });

            circle2.attr({
                fill: "red",
                stroke: "red"
            });

            circle3.attr({
                fill: "red",
                stroke: "red"
            });
        }

        /**
         * Dragging for PCs
         */
        function onDrag(direction_x, direction_y)
        {
            let transform_direction_x;
            let transform_direction_y;
            let snapInvertedMatrix = this.transform().diffMatrix.invert();

            transform_direction_x = snapInvertedMatrix.x(direction_x, direction_y);
            transform_direction_y = snapInvertedMatrix.y(direction_x, direction_y);
            this.transform("t" + [transform_direction_x, transform_direction_y] + this.data('ot'));
        }

        /**
         * Sets where to begin transforming for dragging
         */
        function onBegin()
        {
            this.data('ot', this.transform().local);
        }

        /**
         * Dynamic hover when user's cursor is over the svg image
         */
        function hoverOver()
        {
            document.body.style.cursor = "pointer";
        }

        /**
         * Dynamic hover out, when user's cursor moves off of svg image
         */
        function hoverOut()
        {
            document.body.style.cursor = "default";
        }



        /**
         * Dynamic option for svg when user releases click
         */
        function mouseUp(providedCircle1, providedCircle2, providedCircle3, providedCircle4)
        {
            providedCircle1.attr({
                fill: "blue",
                stroke: "black"
            });
            
            providedCircle2.attr({
                fill: "white",
                stroke: "black"
            })

            providedCircle3.attr({
                fill: "red",
                stroke: "black"
            })
            providedCircle4.attr({
                fill: "forestgreen",
                stroke: "black"
            })

            changeMovingText()
        }

        function changeMovingText()
        {
            document.getElementById("moving_target_text").innerHTML = "Nicely done! Feel anything yet?";
        }

        /**
         * Places the quote from the API into the <p> with id "quote"
         */
        function embedQuote(quote, author)
        {
            document.getElementById('quote').innerHTML = quote
            document.getElementById('author').innerHTML = "- " + author;
        }

        /**
         * Gets a random quote from "https://api.quotable.io/random"
         */
        function fetchQuotes()
        {
            fetch("https://api.quotable.io/random").then((
                response) => response.json()).then((
                quote) => embedQuote(quote.content, quote.author));
        }

        main();

    </script>
</body>
</html>